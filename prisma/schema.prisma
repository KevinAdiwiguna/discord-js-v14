generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Guild {
  guild_id   String      @id @unique
  guild_name String
  Minecraft  Minecraft[]
  Reminder   Reminder[]
  Welcome    Welcome?
}

model Minecraft {
  id                 String     @id @default(uuid())
  guild_id           String
  server_name        String
  server_address     String
  server_port        Int
  server_description String?
  server_type        ServerType @default(JAVA)
  guild              Guild      @relation(fields: [guild_id], references: [guild_id], onDelete: Cascade)
}

enum ServerType {
  JAVA
  BEDROCK
}

model Reminder {
  reminder_id String   @id @default(uuid())
  guild_id    String
  channel_id  String?
  created_by  String
  is_sent     Boolean  @default(false)
  guild       Guild    @relation(fields: [guild_id], references: [guild_id], onDelete: Cascade)
  time        Time?
  message     Message?
}

model Time {
  time_id     String   @id @default(uuid())
  reminder_id String   @unique
  hour        String
  minute      String
  day         String
  month       String
  year        String
  reminder    Reminder @relation(fields: [reminder_id], references: [reminder_id], onDelete: Cascade)
}

model Message {
  message_id  String      @id @default(uuid())
  reminder_id String      @unique
  content     String
  type        MessageType
  images_url  String?
  reminder    Reminder    @relation(fields: [reminder_id], references: [reminder_id], onDelete: Cascade)
  Welcome     Welcome?
}

enum MessageType {
  WELCOME
  REMINDER
}

model Welcome {
  guild_id   String  @id
  channel_id String?
  message_id String  @unique
  guild      Guild   @relation(fields: [guild_id], references: [guild_id], onDelete: Cascade)
  message    Message @relation(fields: [message_id], references: [message_id], onDelete: Cascade)
}